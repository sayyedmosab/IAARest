<div class="bg-white py-12">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-extrabold text-gray-900">Our Delicious Meals</h2>
      <p class="mt-2 text-lg text-gray-500">Explore our wide variety of healthy and tasty dishes.</p>
    </div>

    <!-- Filters -->
    <div class="flex flex-col md:flex-row gap-4 mb-8 items-center">
      <div class="relative flex-grow w-full md:w-auto">
        <input 
          type="text" 
          placeholder="Search by meal name..." 
          class="w-full px-4 py-2 border border-gray-300 focus:ring-red-500 focus:border-red-500"
          (input)="updateSearchTerm($event)"
          [value]="searchTerm()">
        <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="flex flex-wrap gap-2 justify-center">
        <button 
          (click)="filterByTag(null)"
          [class.bg-red-600]="!selectedTag()"
          [class.text-white]="!selectedTag()"
          [class.bg-gray-200]="selectedTag()"
          [class.text-gray-700]="selectedTag()"
          class="px-4 py-2 text-sm font-medium hover:bg-red-500 hover:text-white transition-colors">
          All
        </button>
        @for(tag of allTags(); track tag) {
          <button 
            (click)="filterByTag(tag)"
            [class.bg-red-600]="selectedTag() === tag"
            [class.text-white]="selectedTag() === tag"
            [class.bg-gray-200]="selectedTag() !== tag"
            [class.text-gray-700]="selectedTag() !== tag"
            class="px-4 py-2 text-sm font-medium hover:bg-red-500 hover:text-white transition-colors">
            {{ tag }}
          </button>
        }
      </div>
    </div>
    
    <!-- Meals Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
      @for(meal of filteredMeals(); track meal.id) {
        <div class="group relative bg-white border shadow-md overflow-hidden transform hover:-translate-y-1 transition-transform duration-300">
          <div class="aspect-w-3 aspect-h-2">
            <img class="object-cover w-full h-full" [src]="meal.image_filename | imagePath" [alt]="meal.name">
          </div>
          <div class="p-4">
            <h3 class="text-lg font-semibold text-gray-800">{{ meal.name }}</h3>
            <p class="mt-1 text-sm text-gray-500 h-10 overflow-hidden">{{ meal.description }}</p>
            <div class="mt-4 border-t pt-4">
              <h4 class="text-xs font-bold uppercase text-gray-400">Macros</h4>
              <div class="flex justify-between text-sm mt-1 text-gray-700">
                <span>Calories: <span class="font-semibold">{{ meal.macros.calories }}</span></span>
                <span>Protein: <span class="font-semibold">{{ meal.macros.protein }}g</span></span>
                <span>Carbs: <span class="font-semibold">{{ meal.macros.carbs }}g</span></span>
                <span>Fat: <span class="font-semibold">{{ meal.macros.fat }}g</span></span>
              </div>
            </div>
             <div class="mt-2">
                <div class="flex flex-wrap gap-2">
                  @for(tag of meal.tags; track tag) {
                    <span class="inline-block bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5">{{ tag }}</span>
                  }
                </div>
            </div>
          </div>
        </div>
      } @empty {
        <div class="col-span-full text-center py-12">
            <p class="text-gray-500 text-lg">No meals found matching your criteria.</p>
        </div>
      }
    </div>
  </div>
</div>